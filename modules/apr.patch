diff --git a/apr.mak b/apr.mak
index 43657a0bb..0dd48000d 100644
--- a/apr.mak
+++ b/apr.mak
@@ -119,6 +119,7 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
 	-@erase "$(OUTDIR)\apr-1.lib"
 	-@erase ".\include\apr.h"
@@ -187,6 +188,7 @@ LIB32_OBJS= \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
 	"$(INTDIR)\select.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\apr_random.obj" \
 	"$(INTDIR)\sha2.obj" \
@@ -305,6 +307,7 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
 	-@erase "$(OUTDIR)\apr-1.lib"
 	-@erase ".\include\apr.h"
@@ -373,6 +376,7 @@ LIB32_OBJS= \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
 	"$(INTDIR)\select.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\apr_random.obj" \
 	"$(INTDIR)\sha2.obj" \
@@ -491,6 +495,7 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
 	-@erase "$(OUTDIR)\apr-1.lib"
 	-@erase ".\include\apr.h"
@@ -559,6 +564,7 @@ LIB32_OBJS= \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
 	"$(INTDIR)\select.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\apr_random.obj" \
 	"$(INTDIR)\sha2.obj" \
@@ -677,6 +683,7 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
 	-@erase "$(OUTDIR)\apr-1.lib"
 	-@erase ".\include\apr.h"
@@ -746,6 +753,7 @@ LIB32_OBJS= \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
 	"$(INTDIR)\select.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\apr_random.obj" \
 	"$(INTDIR)\sha2.obj" \
@@ -1107,6 +1115,12 @@ SOURCE=.\network_io\win32\sockopt.c
 	$(CPP) $(CPP_PROJ) $(SOURCE)
 
 
+SOURCE=.\network_io\win32\socket_pipe.c
+
+"$(INTDIR)\socket_pipe.obj" : $(SOURCE) "$(INTDIR)" ".\include\apr.h"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
 SOURCE=.\passwd\apr_getpass.c
 
 "$(INTDIR)\apr_getpass.obj" : $(SOURCE) "$(INTDIR)"
diff --git a/libapr.mak b/libapr.mak
index e998aec28..56815fbaf 100644
--- a/libapr.mak
+++ b/libapr.mak
@@ -118,7 +118,8 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
-	-@erase "$(INTDIR)\wakeup.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
+	-@erase "$(INTDIR)\wakeup.obj"	
 	-@erase "$(OUTDIR)\libapr-1.dll"
 	-@erase "$(OUTDIR)\libapr-1.exp"
 	-@erase "$(OUTDIR)\libapr-1.lib"
@@ -250,7 +251,8 @@ LINK32_OBJS= \
 	"$(INTDIR)\timestr.obj" \
 	"$(INTDIR)\groupinfo.obj" \
 	"$(INTDIR)\userinfo.obj" \
-	"$(INTDIR)\wakeup.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
+	"$(INTDIR)\wakeup.obj" \	
 	"$(INTDIR)\libapr.res"
 
 "$(OUTDIR)\libapr-1.dll" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
@@ -362,7 +364,8 @@ CLEAN :
 	-@erase "$(INTDIR)\userinfo.obj"
 	-@erase "$(INTDIR)\utf8.obj"
 	-@erase "$(INTDIR)\version.obj"
-	-@erase "$(INTDIR)\wakeup.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
+	-@erase "$(INTDIR)\wakeup.obj"	
 	-@erase "$(OUTDIR)\libapr-1.dll"
 	-@erase "$(OUTDIR)\libapr-1.exp"
 	-@erase "$(OUTDIR)\libapr-1.lib"
@@ -494,7 +497,8 @@ LINK32_OBJS= \
 	"$(INTDIR)\timestr.obj" \
 	"$(INTDIR)\groupinfo.obj" \
 	"$(INTDIR)\userinfo.obj" \
-	"$(INTDIR)\wakeup.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
+	"$(INTDIR)\wakeup.obj" \	
 	"$(INTDIR)\libapr.res"
 
 "$(OUTDIR)\libapr-1.dll" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
@@ -579,7 +583,9 @@ CLEAN :
 	-@erase "$(INTDIR)\poll.obj"
 	-@erase "$(INTDIR)\pollcb.obj"
 	-@erase "$(INTDIR)\pollset.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\proc.obj"
 	-@erase "$(INTDIR)\proc_mutex.obj"
 	-@erase "$(INTDIR)\rand.obj"
@@ -715,6 +721,7 @@ LINK32_OBJS= \
 	"$(INTDIR)\poll.obj" \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\select.obj" \
 	"$(INTDIR)\apr_random.obj" \
@@ -823,6 +830,7 @@ CLEAN :
 	-@erase "$(INTDIR)\poll.obj"
 	-@erase "$(INTDIR)\pollcb.obj"
 	-@erase "$(INTDIR)\pollset.obj"
+	-@erase "$(INTDIR)\socket_pipe.obj"
 	-@erase "$(INTDIR)\wakeup.obj"
 	-@erase "$(INTDIR)\proc.obj"
 	-@erase "$(INTDIR)\proc_mutex.obj"
@@ -959,6 +967,7 @@ LINK32_OBJS= \
 	"$(INTDIR)\poll.obj" \
 	"$(INTDIR)\pollcb.obj" \
 	"$(INTDIR)\pollset.obj" \
+	"$(INTDIR)\socket_pipe.obj" \
 	"$(INTDIR)\wakeup.obj" \
 	"$(INTDIR)\select.obj" \
 	"$(INTDIR)\apr_random.obj" \
@@ -1305,6 +1314,12 @@ SOURCE=.\network_io\win32\sockopt.c
 	$(CPP) $(CPP_PROJ) $(SOURCE)
 
 
+SOURCE=.\network_io\win32\socket_pipe.c
+
+"$(INTDIR)\socket_pipe.obj" : $(SOURCE) "$(INTDIR)" ".\include\apr.h"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
 SOURCE=.\passwd\apr_getpass.c
 
 "$(INTDIR)\apr_getpass.obj" : $(SOURCE) "$(INTDIR)" ".\include\apr.h"
